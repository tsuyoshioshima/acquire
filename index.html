<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>アクワイア計算機</title>
</head>
<body>
  <h1>アクワイア計算機</h1>
  <div id="app">
    <table border=1>
      <thead>
        <tr>
          <th>ホテル名</th>
          <th>軒数</th>
          <th>株価</th>
          <th>１位</th>
          <th>２位</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Tow<br>
            <button v-on:click="h.tow = 0;">倒産</button>
          </td>
          <td>{{ h.tow }} 件<br>
            <button v-show="h.tow != 41" v-on:click="h.tow++;">+</button>
            <button v-show="h.tow != 0" v-on:click="h.tow--;">-</button>
          </td>
          <td>{{ s_tow }}</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <td>Lux<br>
            <button v-on:click="h.lux = 0;">倒産</button></td>
          <td>{{ h.lux }} 件<br>
            <button v-show="h.lux != 41" v-on:click="h.lux++;">+</button>
            <button v-show="h.lux != 0" v-on:click="h.lux--;">-</button>
          </td>
          <td>{{ s_lux }}</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <td>Fes<br>
            <button v-on:click="h.fes = 0;">倒産</button></td>
            <td>{{ h.fes }} 件<br>
              <button v-show="h.fes != 41" v-on:click="h.fes++;">+</button>
              <button v-show="h.fes != 0" v-on:click="h.fes--;">-</button>
            </td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <td>Ame<br>
            <button v-on:click="h.ame = 0;">倒産</button></td>
            <td>{{ h.ame }} 件<br>
              <button v-show="h.ame != 41" v-on:click="h.ame++;">+</button>
              <button v-show="h.ame != 0" v-on:click="h.ame--;">-</button>
            </td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <td>Wor<br>
            <button v-on:click="h.wor = 0;">倒産</button>
          </td>
          <td>{{ h.wor }} 件<br>
            <button v-show="h.wor != 41" v-on:click="h.wor++;">+</button>
            <button v-show="h.wor != 0" v-on:click="h.wor--;">-</button>
          </td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <td>Imp<br>
            <button v-on:click="h.imp = 0;">倒産</button>
          </td>
          <td>{{ h.imp }} 件<br>
            <button v-show="h.imp != 41" v-on:click="h.imp++;">+</button>
            <button v-show="h.imp != 0" v-on:click="h.imp--;">-</button>
          </td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <td>Con<br>
            <button v-on:click="h.con = 0;">倒産</button>
          </td>
          <td>{{ h.con }} 件<br>
            <button v-show="h.con != 41" v-on:click="h.con++;">+</button>
            <button v-show="h.con != 0" v-on:click="h.con--;">-</button>
          </td>
          <td>0</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
      </tbody>
    </table>
    <div><button v-on:click="clear_hotel">ホテル全クリア</button></td>
    </div>
    <table border=1>
    <thead>
      <th>ホテル名</th>
      <th>１番手</th>
      <th>２番手</th>
      <th>３番手</th>
      <th>４番手</th>
    </thead>
    <tbody>
      <tr>
        <td>Tow</td>
        <td>{{ p1.tow }}<br>
          <button v-show="p1.tow != 41" v-on:click="p1.tow++;">+</button>
          <button v-show="p1.tow != 0" v-on:click="p1.tow--;">-</button>
        </td>
        <td>{{ p2.tow }}<br>
          <button v-show="p2.tow != 41" v-on:click="p2.tow++;">+</button>
          <button v-show="p2.tow != 0" v-on:click="p2.tow--;">-</button>
        </td>
        <td>{{ p3.tow }}<br>
          <button v-show="p3.tow != 41" v-on:click="p3.tow++;">+</button>
          <button v-show="p3.tow != 0" v-on:click="p3.tow--;">-</button>
        </td>
        <td>{{ p4.tow }}<br>
          <button v-show="p4.tow != 41" v-on:click="p4.tow++;">+</button>
          <button v-show="p4.tow != 0" v-on:click="p4.tow--;">-</button>
        </td>
      </tr>
      <tr>
        <td>Lux</td>
        <td>{{ p1.lux }}<br>
          <button v-show="p1.lux != 41" v-on:click="p1.lux++;">+</button>
          <button v-show="p1.lux != 0" v-on:click="p1.lux--;">-</button>
        </td>
        <td>{{ p2.lux }}<br>
          <button v-show="p2.lux != 41" v-on:click="p2.lux++;">+</button>
          <button v-show="p2.lux != 0" v-on:click="p2.lux--;">-</button>
        </td>
        <td>{{ p3.lux }}<br>
          <button v-show="p3.lux != 41" v-on:click="p3.lux++;">+</button>
          <button v-show="p3.lux != 0" v-on:click="p3.lux--;">-</button>
        </td>
        <td>{{ p4.lux }}<br>
          <button v-show="p4.lux != 41" v-on:click="p4.lux++;">+</button>
          <button v-show="p4.lux != 0" v-on:click="p4.lux--;">-</button>
        </td>
      </tr>
      <tr>
        <td>Fes</td>
        <td>{{ p1.fes }}<br>
          <button v-show="p1.fes != 41" v-on:click="p1.fes++;">+</button>
          <button v-show="p1.fes != 0" v-on:click="p1.fes--;">-</button>
        </td>
        <td>{{ p2.fes }}<br>
          <button v-show="p2.fes != 41" v-on:click="p2.fes++;">+</button>
          <button v-show="p2.fes != 0" v-on:click="p2.fes--;">-</button>
        </td>
        <td>{{ p3.fes }}<br>
          <button v-show="p3.fes != 41" v-on:click="p3.fes++;">+</button>
          <button v-show="p3.fes != 0" v-on:click="p3.fes--;">-</button>
        </td>
        <td>{{ p4.fes }}<br>
          <button v-show="p4.fes != 41" v-on:click="p4.fes++;">+</button>
          <button v-show="p4.fes != 0" v-on:click="p4.fes--;">-</button>
        </td>
      </tr>
      <tr>
        <td>Ame</td>
        <td>{{ p1.ame }}<br>
          <button v-show="p1.ame != 41" v-on:click="p1.ame++;">+</button>
          <button v-show="p1.ame != 0" v-on:click="p1.ame--;">-</button>
        </td>
        <td>{{ p2.ame }}<br>
          <button v-show="p2.ame != 41" v-on:click="p2.ame++;">+</button>
          <button v-show="p2.ame != 0" v-on:click="p2.ame--;">-</button>
        </td>
        <td>{{ p3.ame }}<br>
          <button v-show="p3.ame != 41" v-on:click="p3.ame++;">+</button>
          <button v-show="p3.ame != 0" v-on:click="p3.ame--;">-</button>
        </td>
        <td>{{ p4.ame }}<br>
          <button v-show="p4.ame != 41" v-on:click="p4.ame++;">+</button>
          <button v-show="p4.ame != 0" v-on:click="p4.ame--;">-</button>
        </td>
      </tr>
      <tr>
        <td>Wor</td>
        <td>{{ p1.wor }}<br>
          <button v-show="p1.wor != 41" v-on:click="p1.wor++;">+</button>
          <button v-show="p1.wor != 0" v-on:click="p1.wor--;">-</button>
        </td>
        <td>{{ p2.wor }}<br>
          <button v-show="p2.wor != 41" v-on:click="p2.wor++;">+</button>
          <button v-show="p2.wor != 0" v-on:click="p2.wor--;">-</button>
        </td>
        <td>{{ p3.wor }}<br>
          <button v-show="p3.wor != 41" v-on:click="p3.wor++;">+</button>
          <button v-show="p3.wor != 0" v-on:click="p3.wor--;">-</button>
        </td>
        <td>{{ p4.wor }}<br>
          <button v-show="p4.wor != 41" v-on:click="p4.wor++;">+</button>
          <button v-show="p4.wor != 0" v-on:click="p4.wor--;">-</button>
        </td>
      </tr>
      <tr>
        <td>Imp</td>
        <td>{{ p1.imp }}<br>
          <button v-show="p1.imp != 41" v-on:click="p1.imp++;">+</button>
          <button v-show="p1.imp != 0" v-on:click="p1.imp--;">-</button>
        </td>
        <td>{{ p2.imp }}<br>
          <button v-show="p2.imp != 41" v-on:click="p2.imp++;">+</button>
          <button v-show="p2.imp != 0" v-on:click="p2.imp--;">-</button>
        </td>
        <td>{{ p3.imp }}<br>
          <button v-show="p3.imp != 41" v-on:click="p3.imp++;">+</button>
          <button v-show="p3.imp != 0" v-on:click="p3.imp--;">-</button>
        </td>
        <td>{{ p4.imp }}<br>
          <button v-show="p4.imp != 41" v-on:click="p4.imp++;">+</button>
          <button v-show="p4.imp != 0" v-on:click="p4.imp--;">-</button>
        </td>
      </tr>
      <tr>
        <td>Con</td>
        <td>{{ p1.con }}<br>
          <button v-show="p1.con != 41" v-on:click="p1.con++;">+</button>
          <button v-show="p1.con != 0" v-on:click="p1.con--;">-</button>
        </td>
        <td>{{ p2.con }}<br>
          <button v-show="p2.con != 41" v-on:click="p2.con++;">+</button>
          <button v-show="p2.con != 0" v-on:click="p2.con--;">-</button>
        </td>
        <td>{{ p3.con }}<br>
          <button v-show="p3.con != 41" v-on:click="p3.con++;">+</button>
          <button v-show="p3.con != 0" v-on:click="p3.con--;">-</button>
        </td>
        <td>{{ p4.con }}<br>
          <button v-show="p4.con != 41" v-on:click="p4.con++;">+</button>
          <button v-show="p4.con != 0" v-on:click="p4.con--;">-</button>
        </td>
      </tr>
      <tr><td>現金除いた合計</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr>
      <tr><td>株券</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr>
      <tr><td>ボーナス</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr>
    </tbody>
  </table>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script>
    var app = new Vue({
      el: '#app',
      data: {
        // h: ホテルの軒数（hotel）
        h: { tow: 0, lux: 0, fes: 0, ame: 0, wor: 0, imp: 0, con: 0 }, 
        // 全プレイヤーの所持株数
        p: { tow: 0, lux: 0, fes: 0, ame: 0, wor: 0, imp: 0, con: 0 }, 
        //１番手の所持株数
        p1: { tow: 0, lux: 0, fes: 0, ame: 0, wor: 0, imp: 0, con: 0 },
        //２番手の所持株数
        p2: { tow: 0, lux: 0, fes: 0, ame: 0, wor: 0, imp: 0, con: 0 },
        //３番手の所持株数
        p3: { tow: 0, lux: 0, fes: 0, ame: 0, wor: 0, imp: 0, con: 0 },
        //４番手の所持株数
        p4: { tow: 0, lux: 0, fes: 0, ame: 0, wor: 0, imp: 0, con: 0 } 
      },
      methods: {
        //ホテルの軒数を全クリア
        clear_hotel: function() {
          this.h.tow = 0,
          this.h.lux = 0,
          this.h.fes = 0,
          this.h.ame = 0,
          this.h.wor = 0,
          this.h.imp = 0,
          this.h.con = 0
          return;
        },
      },
      computed: {
        // Tow & Lux 株価計算式
        //=IFS(C3=0,"0",C3=1,"0",C3=2,"200",C3=3,"300",C3=4,"400",C3=5,"500",AND(C3>=6,C3<=10),"600",AND(C3>=11,C3<=20),"700",AND(C3>=21,C3<=30),"800",AND(C3>=31,C3<=40),"900",C3<=41,"1000")

        // Tow の株価（stock price of Tow）
        s_tow: function() {
          if (this.h.tow <= 1) {
            return 0
          } else if (this.h.tow >= 2 && this.h.tow <= 5) {
            return this.h.tow * 100
          } else if (this.h.tow >= 6 && this.h.tow <= 10) {
            return 600
          } else if (this.h.tow >= 11 && this.h.tow <= 20) {
            return 700
          } else if (this.h.tow >= 21 && this.h.tow <= 30) {
            return 800
          } else if (this.h.tow >= 31 && this.h.tow <= 40) {
            return 900
          } else if (this.h.tow <= 41) {
            return 1000
          }
        },

        // Lux の株価（stock price of Lux）
        s_lux: function() {
          if (this.h.lux <= 1) {
            return 0
          } else if (this.h.lux >= 2 && this.h.lux <= 5) {
            return this.h.lux * 100
          } else if (this.h.lux >= 6 && this.h.lux <= 10) {
            return 600
          } else if (this.h.lux >= 11 && this.h.lux <= 20) {
            return 700
          } else if (this.h.lux >= 21 && this.h.lux <= 30) {
            return 800
          } else if (this.h.lux >= 31 && this.h.lux <= 40) {
            return 900
          } else if (this.h.lux <= 41) {
            return 1000
          }
        },

        // Fes / Ame / Wor の株価計算式
        // =IFS(C7=0,"0",C7=1,"0",C7=2,"300",C7=3,"400",C7=4,"500",C7=5,"600",AND(C7>=6,C7<=10),"700",AND(C7>=11,C7<=20),"800",AND(C7>=21,C7<=30),"900",AND(C7>=31,C7<=40),"1000",C7<=41,"1100")

        // Fes の株価
        s_fes: function () {
          if (this.h.fes <= 1) {
            return 0
          } else if (this.h.fes >= 2 && this.h.fes <= 5) {
            return this.h.fes * 100 + 100
          } else if (this.h.fes >= 6 && this.h.fes <= 10) {
            return 700
          } else if (this.h.fes >= 11 && this.h.fes <= 20) {
            return 800
          } else if (this.h.fes >= 21 && this.h.fes <= 30) {
            return 900
          } else if (this.h.fes >= 31 && this.h.fes <= 40) {
            return 1000
          } else if (this.h.fes <= 41) {
            return 1100
          }
        },

        // Ame の株価
        s_ame: function () {
          if (this.h.ame <= 1) {
            return 0
          } else if (this.h.ame >= 2 && this.h.ame <= 5) {
            return this.h.ame * 100 + 100
          } else if (this.h.ame >= 6 && this.h.ame <= 10) {
            return 700
          } else if (this.h.ame >= 11 && this.h.ame <= 20) {
            return 800
          } else if (this.h.ame >= 21 && this.h.ame <= 30) {
            return 900
          } else if (this.h.ame >= 31 && this.h.ame <= 40) {
            return 1000
          } else if (this.h.ame <= 41) {
            return 1100
          }
        },

        // Wor の株価
        s_wor: function () {
          if (this.h.wor <= 1) {
            return 0
          } else if (this.h.wor >= 2 && this.h.wor <= 5) {
            return this.h.wor * 100 + 100
          } else if (this.h.wor >= 6 && this.h.wor <= 10) {
            return 700
          } else if (this.h.wor >= 11 && this.h.wor <= 20) {
            return 800
          } else if (this.h.wor >= 21 && this.h.wor <= 30) {
            return 900
          } else if (this.h.wor >= 31 && this.h.wor <= 40) {
            return 1000
          } else if (this.h.wor <= 41) {
            return 1100
          }
        },

        // Imp / Con の株価計算式
        // =IFS(C13=0,"0",C13=1,"0",C13=2,"400",C13=3,"500",C13=4,"600",C13=5,"700",AND(C13>=6,C13<=10),"800",AND(C13>=11,C13<=20),"900",AND(C13>=21,C13<=30),"1000",AND(C13>=31,C13<=40),"1100",C13<=41,"1200")

        // Imp の株価
        s_imp: function () {
          if (this.h.imp <= 1) {
            return 0
          } else if (this.h.imp >= 2 && this.h.imp <= 5) {
            return this.h.imp * 100 + 200
          } else if (this.h.imp >= 6 && this.h.imp <= 10) {
            return 800
          } else if (this.h.imp >= 11 && this.h.imp <= 20) {
            return 900
          } else if (this.h.imp >= 21 && this.h.imp <= 30) {
            return 1000
          } else if (this.h.imp >= 31 && this.h.imp <= 40) {
            return 1100
          } else if (this.h.imp <= 41) {
            return 1200
          }
        },

        // Con の株価
        s_con: function () {
          if (this.h.con <= 1) {
            return 0
          } else if (this.h.con >= 2 && this.h.con <= 5) {
            return this.h.con * 100 + 200
          } else if (this.h.con >= 6 && this.h.con <= 10) {
            return 800
          } else if (this.h.con >= 11 && this.h.con <= 20) {
            return 900
          } else if (this.h.con >= 21 && this.h.con <= 30) {
            return 1000
          } else if (this.h.con >= 31 && this.h.con <= 40) {
            return 1100
          } else if (this.h.con <= 41) {
            return 1200
          }
        }
      }, // computed
    });
    //合併ボーナス
    //=roundup(E3*Q4,-2)
    // １位　E3 株価×
    // =IF(countif(I3:L3,"0")=4,0,O4*(10*P4+15*(1-P4))+(1-O4)*15/N4)
  </script>
</body>
</html>